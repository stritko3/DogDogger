<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dog Dodger</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-image: url('Background.jpg');
      background-size: cover;
      background-position: center;
    }

    #gameCanvas {
      display: block;
      margin: 0 auto;
      background-color: rgba(240, 240, 240, 0.5);
    }

    #timer {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 30px;
      color: red;
      font-family: Arial, sans-serif;
    }

    #startButton, #restartButton {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 10px 20px;
      font-size: 20px;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
    }

    #restartButton {
      display: none; /* Hide the restart button initially */
    }

  </style>
</head>
<body>

<canvas id="gameCanvas"></canvas>
<div id="timer">0</div>
<button id="startButton">Start Game</button>
<button id="restartButton">Restart Game</button>

<script>
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;

  const dogImages = [
    new Image(), new Image(), new Image(), new Image()
  ];
  dogImages[0].src = 'Dog1.png';
  dogImages[1].src = 'Dog2.png';
  dogImages[2].src = 'Dog3.png';
  dogImages[3].src = 'Dog4.png';

  const anvilImage = new Image();
  anvilImage.src = 'Anvil.png';

  let dogX = canvas.width / 2 - 50;
  let dogY = canvas.height - 150;
  let dogIndex = 0;
  let anvils = [];
  let gameSpeed = 5;
  let squareSpeed = 5;
  let leftPressed = false;
  let rightPressed = false;
  let gameOver = false;

  let lastUpdateTime = 0;
  let startTime = performance.now();
  let spawnInterval = 1000;
  let lastSpawnTime = 0;
  let maxAnvils = 5;

  function drawDog() {
    ctx.clearRect(dogX, dogY, 100, 100);
    const flip = rightPressed ? -1 : 1;

    ctx.save();
    ctx.scale(flip, 1);
    ctx.drawImage(dogImages[dogIndex], (flip === -1 ? -dogX - 100 : dogX), dogY, 100, 100);
    ctx.restore();
  }

  function drawAnvil(anvil) {
    ctx.drawImage(anvilImage, anvil.x, anvil.y, 50, 50);
  }

  function moveAnvils() {
    for (let i = 0; i < anvils.length; i++) {
      anvils[i].y += squareSpeed;

      if (anvils[i].y + 50 > dogY && anvils[i].y < dogY + 100 && 
          anvils[i].x + 50 > dogX && anvils[i].x < dogX + 100) {
        gameOver = true;
        alert("Game Over!");
        document.getElementById('restartButton').style.display = 'block'; // Show restart button
        break;
      }

      if (anvils[i].y > canvas.height) {
        anvils.splice(i, 1);
        i--;
      }
    }
  }

  function createAnvil() {
    if (anvils.length < maxAnvils) {
      const x = Math.random() * (canvas.width - 50);
      anvils.push({ x, y: -50 });
    }
  }

  function adjustSpawnSpeed(elapsedTime) {
    if (elapsedTime >= 60) {
      spawnInterval = 2000;
      maxAnvils = 6;
    } else if (elapsedTime >= 40) {
      squareSpeed = 10;
      spawnInterval = Math.max(2000, spawnInterval - 200);
    } else if (elapsedTime >= 30) {
      squareSpeed = 8;
      spawnInterval = Math.max(2500, spawnInterval - 300);
    } else if (elapsedTime >= 20) {
      squareSpeed = 6;
      spawnInterval = Math.max(3000, spawnInterval - 400);
    } else if (elapsedTime >= 10) {
      squareSpeed = 5;
      spawnInterval = Math.max(3500, spawnInterval - 500);
    }
  }

  function gameLoop(currentTime) {
    if (gameOver) return;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const elapsedTime = (currentTime - startTime) / 1000;

    adjustSpawnSpeed(elapsedTime);

    if (leftPressed && dogX > 0) {
      dogX -= 5;
    }
    if (rightPressed && dogX < canvas.width - 100) {
      dogX += 5;
    }

    if (leftPressed || rightPressed) {
      if (currentTime - lastUpdateTime > 100) {
        dogIndex = (dogIndex + 1) % 4;
        lastUpdateTime = currentTime;
      }
    } else {
      dogIndex = 0;
    }

    drawDog();

    for (let i = 0; i < anvils.length; i++) {
      drawAnvil(anvils[i]);
    }

    moveAnvils();

    if (currentTime - lastSpawnTime > spawnInterval / 1000) {
      createAnvil();
      lastSpawnTime = currentTime;
    }

    const secondsElapsed = Math.floor(elapsedTime);
    document.getElementById('timer').textContent = secondsElapsed;

    requestAnimationFrame(gameLoop);
  }

  document.addEventListener('keydown', (event) => {
    if (event.key === 'ArrowLeft') {
      leftPressed = true;
    }
    if (event.key === 'ArrowRight') {
      rightPressed = true;
    }
  });

  document.addEventListener('keyup', (event) => {
    if (event.key === 'ArrowLeft') {
      leftPressed = false;
    }
    if (event.key === 'ArrowRight') {
      rightPressed = false;
    }
  });

  let imagesLoaded = 0;
  dogImages.forEach((image) => {
    image.onload = () => {
      imagesLoaded++;
      if (imagesLoaded === dogImages.length) {
        anvilImage.onload = () => {
          document.getElementById('startButton').onclick = startGame;
          document.getElementById('restartButton').onclick = restartGame;
        };
      }
    };
  });

  function startGame() {
    document.getElementById('startButton').style.display = 'none'; // Hide the start button
    requestAnimationFrame(gameLoop);
  }

  function restartGame() {
    document.getElementById('restartButton').style.display = 'none'; // Hide the restart button
    gameOver = false;
    dogX = canvas.width / 2 - 50;
    dogY = canvas.height - 150;
    anvils = [];
    startTime = performance.now();
    lastSpawnTime = 0;
    document.getElementById('timer').textContent = '0';
    document.getElementById('startButton').style.display = 'block'; // Show start button again if needed
    requestAnimationFrame(gameLoop);
  }
</script>

</body>
</html>
